# Опис проєкту: Побудова рекомендаційної системи стрімерів для користувачів

### Задача
Метою проєкту було розробити модель для прогнозування ймовірності того, чи відправить користувач подарунок стрімеру на стрімінговій платформі. Задача включала аналіз даних користувачів, стрімерів та їхньої взаємодії під час подій (стрімів, відправки подарунків тощо). Основна мета — підвищити ефективність рекомендацій для користувачів і краще розуміти їхню поведінку.

### Кроки виконання

1. **Очищення та підготовка даних**
   - Завантажили та попередньо оглянули три набори даних: *Users*, *Streamers*, *Users’ Activity*.
   - Видалили дублікати та пропуски для забезпечення якості даних.
   - Видалили колонки, які не допомагали у прогнозуванні, зокрема `event_date`, `event_timestamp`, ідентифікатори та інші тимчасові змінні.
   - Заповнили відсутні значення для числових ознак, таких як кількість підписок і кількість фоловерів, значеннями 0.

2. **Формування нових ознак**
   - Створено нові змінні для моделі, такі як:
     - `days_since_user_install` — кількість днів з моменту інсталяції додатку користувачем до події.
     - `days_since_streamer_install` — кількість днів з моменту інсталяції додатку стрімером.
     - `coins_per_day_streamer` — середня кількість монет, зароблених стрімером за день.

3. **Кодування категоріальних змінних**
   - Використали *One-Hot Encoding* для категоріальних ознак, таких як стать користувача та стрімера, джерело інсталяції додатку (*media_source*).
   - Перетворили булеві змінні у формат 0 та 1 для полегшення їх використання в моделюванні.

4. **Балансування цільової змінної**
   - Цільова змінна (відправка подарунку) була дуже незбалансованою: більшість користувачів не надсилали подарунки. Для вирішення цієї проблеми ми провели ресемплінг класів, щоб збалансувати кількість прикладів для обох класів.

5. **Моделювання**
   - Для побудови моделі використовували три алгоритми:
     - Логістична регресія.
     - *Random Forest*.
     - *XGBoost*.
   - Модель *XGBoost* показала найкращі результати з точністю та значенням *F1-міри* в 82%.

6. **Аналіз важливості ознак**
   - Використали *SHAP*-аналіз для оцінки важливості кожної ознаки. Найважливішими факторами виявилися:
     - Кількість днів з моменту інсталяції додатку користувачем.
     - Кількість підписок на стрімерів.
     - Стать користувача (чоловіки частіше надсилали подарунки).
     - Середня тривалість стрімів стрімерів.

7. **Візуалізація та аналітика**
   - Згенерували *Partial Dependence Plots* (PDP) для найважливіших змінних. PDP дозволив побачити, як зміни значення ознак впливають на ймовірність надсилання подарунків користувачем.

### Результати
- **Точність прогнозу**: Модель *XGBoost* досягла точності 82% на збалансованому наборі даних, перевершивши інші моделі.
- **Важливі фактори**:
  - Кількість днів з моменту інсталяції додатку: користувачі, які нещодавно встановили додаток, частіше надсилали подарунки.
  - Стать: чоловіки більш схильні до надсилання подарунків у порівнянні з іншими категоріями.
  - Кількість підписок: користувачі з меншою кількістю підписок на стрімерів частіше надсилали подарунки.
  - Середня тривалість стрімів: коротші стріми частіше отримували подарунки.

### Висновки
Модель *XGBoost* забезпечила найкращу продуктивність у порівнянні з іншими алгоритмами. Аналіз на основі *SHAP* та *Partial Dependence Plots* допоміг зрозуміти ключові фактори, що впливають на поведінку користувачів. Отримані висновки можуть бути використані для налаштування рекомендаційної системи та розробки індивідуальних пропозицій для користувачів платформи.
